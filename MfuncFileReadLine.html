<html>
	
<head>
	<title>FileReadLine()</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="keywords" content="FileReadLine, File">
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/custom.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->
	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/hnd.js"></script>
	<script type="text/javascript">
		$(document).ready(function()
		{
			if (top.frames.length == 0)
			{
				var sTopicUrl = top.location.href.substring(top.location.href.lastIndexOf("/") + 1, top.location.href.length);
				top.location.href = "index.html?" + sTopicUrl
			}
			else
			{
				var bTocSelected = false;
				(function waitForTOC()
				{
					if (top && top.FrameTOC && top.FrameTOC.SelectTocItem)
					{
						top.FrameTOC.SelectTocItem("MfuncFileReadLine");
						bTocSelected = true;
					}
					if (!bTocSelected) setTimeout(function() { waitForTOC(); }, 300);
				})();
			}
		});
	</script>
	
	</head>

<body>

<div id="topic_header">
			<div id="topic_header_content">
				<h1 id="topic_header_text">FileReadLine()</h1>
				
				<div id="topic_breadcrumb">
					<a href="NameSapce.html">Namespace</a> &rsaquo;&rsaquo; <a href="NS_System.html">System</a> &rsaquo;&rsaquo; <a href="Mfunc.html">Mfunc</a> &rsaquo;&rsaquo; <a href="MfuncMethods.html">Methods</a> &rsaquo;&rsaquo; </div>
				</div>
			<div id="topic_header_nav">
				<a href="MfuncMethods.html"><img src="img/arrow_up.png" alt="Parent"/></a>
				
				<a href="MfuncFileRead.html"><img src="img/arrow_left.png" alt="Previous"/></a>
				
				<a href="MfuncFileRemoveDir.html"><img src="img/arrow_right.png" alt="Next"/></a>
				
				</div>
			<div class="clear"></div>
		</div>
	<div id="topic_content">
		
<p></p>
<h1 class="rvps11"><span class="rvts0"><span class="rvts28">FileReadLine()</span></span></h1>
<p class="rvps20"><span class="rvts49">OutputVar := Mfunc.FileReadLine(Filename, LineNum)</span></p>
<h2 class="rvps5"><span class="rvts0"><span class="rvts16">Mfunc.FileReadLine(Filename, LineNum)</span></span></h2>
<p class="rvps2"><span class="rvts6">Reads the specified line from a file and returns the text.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Parameters</span></span></h3>
<p class="rvps21"><span class="rvts52">Filename</span></p>
<p class="rvps22"><span class="rvts54">The name of the file to access, which is assumed to be in </span><a class="rvts60" href="http://ahkscript.org/docs/Variables.htm#WorkingDir" target="_blank">%A_WorkingDir%</a><span class="rvts54"> if an absolute path isn't specified. Windows and Unix formats are supported; that is, the file's lines may end in either carriage return and linefeed (`r`n) or just linefeed (`n).</span><br/><span class="rvts54"></span><br/><span class="rvts54">Can be </span><a class="rvts53" href="MfString.html">MfString</a><span class="rvts54"> instance or var containing string.</span></p>
<p class="rvps21"><span class="rvts52">LineNum</span></p>
<p class="rvps22"><span class="rvts54">Which line to read (1 is the first, 2 the second, and so on). This can be an </span><a class="rvts60" href="http://ahkscript.org/docs/Variables.htm#Expressions" target="_blank">expression</a><span class="rvts54">.</span><br/><span class="rvts54">If the specified line number is greater than the number of lines in the file, </span><a class="rvts60" href="http://ahkscript.org/docs/misc/ErrorLevel.htm" target="_blank">ErrorLevel</a><span class="rvts54"> is set to 1 and Return value is not changed. This also happens when the specified line number is the last line in the file but that line is blank and does not end in a newline/CRLF.</span><br/><span class="rvts54"></span><br/><span class="rvts54">Can be </span><a class="rvts53" href="MfInteger.html">MfInteger</a><span class="rvts54"> instance or var containing integer.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Returns</span></span></h3>
<p class="rvps2"><span class="rvts6">Returns the retrieved text.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Throws</span></span></h3>
<p class="rvps2"><span class="rvts6">Throws </span><a class="rvts12" href="MfException.html">MfException</a><span class="rvts6"> is non-zero then </span><a class="rvts12" href="MfExceptionInnerException.html">InnerException</a><span class="rvts6"> has a message of </span><a class="rvts13" href="http://ahkscript.org/docs/Variables.htm#LastError" target="_blank">A_LastError</a><span class="rvts6">.</span><br/><span class="rvts6">If the specified line number is greater than the number of lines in the file then </span><a class="rvts12" href="MfException.html">MfException</a><span class="rvts6"> is thrown with </span><a class="rvts12" href="MfExceptionInnerException.html">InnerException</a><span class="rvts6">. This also happens when the specified line number is the last line in the file but that line is blank and does not end in a newline/CRLF.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Remarks</span></span></h3>
<p class="rvps2"><span class="rvts6">Wrapper for </span><a class="rvts13" href="http://ahkscript.org/docs/commands/FileCreateDir.htm" target="_blank">AutoHotkey Docs - FileCreateDir</a><span class="rvts6">.</span><br/><span class="rvts6">Static method.</span></p>
<p class="rvps2"><span class="rvts6">It is strongly recommended to use this command only for small files, or in cases where only a single line of text is needed. To scan and process a large number of lines (one by one), use a &nbsp;</span><a class="rvts13" href="http://ahkscript.org/docs/commands/LoopReadFile.htm" target="_blank">file-reading loop</a><span class="rvts6"> for best performance. To read an entire file into a variable, use </span><a class="rvts12" href="MfuncFileRead.html">Mfunc.FileRead</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6">Although any leading and trailing tabs and spaces present in the line will be written to return value, the linefeed character (`n) at the end of the line will not. Tabs and spaces can be trimmed from both ends of any variable by assigning it to itself while </span><a class="rvts13" href="http://ahkscript.org/docs/commands/AutoTrim.htm" target="_blank">AutoTrim</a><span class="rvts6"> is on (the default). For example:</span><br/><span class="rvts6">MyLine = %MyLine%.</span></p>
<p class="rvps2"><span class="rvts6">Lines up to 65,534 characters long can be read. If the length of a line exceeds this, the remaining characters cannot be retrieved by this method.</span></p>
<p class="rvps2"><span class="rvts6">See Also:</span><a class="rvts13" href="http://ahkscript.org/docs/commands/FileCreateDir.htm" target="_blank">AutoHotkey Docs - FileCreateDir</a><span class="rvts6">.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Example</span></span></h3>
<p class="rvps14"><span class="rvts33">Loop</span><br/><span class="rvts31">{ </span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts33">try</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31">{</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31">line := </span><span class="rvts34">Mfunc</span><span class="rvts31">.</span><span class="rvts47">FileReadLine</span><span class="rvts31">(</span><span class="rvts42">"C:\My Documents\ContactList.txt"</span><span class="rvts31">, </span><span class="rvts33">A_Index</span><span class="rvts31">)</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31">}</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts33">catch</span><span class="rvts31"> e</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31">{</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts33">break</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31">}</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts33">MsgBox</span><span class="rvts31">, </span><span class="rvts68">4</span><span class="rvts31">, , Line #%A_Index% is "%line%". Continue?</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts33">IfMsgBox</span><span class="rvts31">, </span><span class="rvts33">No</span><br/><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts31"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts33">return</span><span class="rvts31"> </span><br/><span class="rvts31">}</span><br/><span class="rvts33">MsgBox</span><span class="rvts31">, The end of the file has been reached or there was a problem. return</span></p>
</div>
	
	<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2013-2017  by Paul Moss. All Rights Reserved.</div>
		</div>
	</body>
	
</html>

