<html>
	
<head>
	<title>FormatTime()</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="keywords" content="Time, FormatTime, Format">
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/custom.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->
	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/hnd.js"></script>
	<script type="text/javascript">
		$(document).ready(function()
		{
			if (top.frames.length == 0)
			{
				var sTopicUrl = top.location.href.substring(top.location.href.lastIndexOf("/") + 1, top.location.href.length);
				top.location.href = "index.html?" + sTopicUrl
			}
			else
			{
				var bTocSelected = false;
				(function waitForTOC()
				{
					if (top && top.FrameTOC && top.FrameTOC.SelectTocItem)
					{
						top.FrameTOC.SelectTocItem("MfuncFormatTime");
						bTocSelected = true;
					}
					if (!bTocSelected) setTimeout(function() { waitForTOC(); }, 300);
				})();
			}
		});
	</script>
	
	</head>

<body>

<div id="topic_header">
			<div id="topic_header_content">
				<h1 id="topic_header_text">FormatTime()</h1>
				
				<div id="topic_breadcrumb">
					<a href="NameSapce.html">Namespace</a> &rsaquo;&rsaquo; <a href="NS_System.html">System</a> &rsaquo;&rsaquo; <a href="Mfunc.html">Mfunc</a> &rsaquo;&rsaquo; <a href="MfuncMethods.html">Methods</a> &rsaquo;&rsaquo; </div>
				</div>
			<div id="topic_header_nav">
				<a href="MfuncMethods.html"><img src="img/arrow_up.png" alt="Parent"/></a>
				
				<a href="MfuncFileSetAttrib.html"><img src="img/arrow_left.png" alt="Previous"/></a>
				
				<a href="MfuncFunctions.html"><img src="img/arrow_right.png" alt="Next"/></a>
				
				</div>
			<div class="clear"></div>
		</div>
	<div id="topic_content">
		
<p></p>
<h1 class="rvps11"><span class="rvts0"><span class="rvts28">FormatTime()</span></span></h1>
<p class="rvps20"><span class="rvts49">OutputVar := Mfunc.FormatTime([YYYYMMDDHH24MISS, Format])</span></p>
<h2 class="rvps5"><span class="rvts0"><span class="rvts16">Mfunc.FormatTime([YYYYMMDDHH24MISS, Format])</span></span></h2>
<p class="rvps2"><span class="rvts6">Transforms a </span><a class="rvts13" href="http://ahkscript.org/docs/commands/FileSetTime.htm#YYYYMMDD" target="_blank">YYYYMMDDHH24MISS</a><span class="rvts6"> timestamp into the specified date/time format.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Parameters</span></span></h3>
<p class="rvps21"><span class="rvts52">YYYYMMDDHH24MISS</span></p>
<p class="rvps22"><span class="rvts54">Leave this parameter blank to use the current local date and time. Otherwise, specify all or the leading part of a timestamp in the </span><a class="rvts60" href="http://ahkscript.org/docs/commands/FileSetTime.htm#YYYYMMDD" target="_blank">YYYYMMDDHH24MISS</a><span class="rvts54"> format. If the date and/or time portion of the timestamp is invalid -- such as February 29th of a non-leap year -- the date and/or time will be omitted from return value. Although only years between 1601 and 9999 are supported, a formatted time can still be produced for earlier years as long as the time portion is valid.</span><br/><span class="rvts54"></span><br/><span class="rvts54">Can be </span><a class="rvts53" href="MfString.html">MfString</a><span class="rvts54"> instance or var containing string.</span></p>
<p class="rvps21"><span class="rvts52">Format</span></p>
<p class="rvps22"><span class="rvts54">If omitted, it defaults to the time followed by the long date, both of which will be formatted according to the current user's locale. For example: 4:55 PM Saturday, November 27, 2004</span><br/><span class="rvts54">Otherwise, specify one or more of the date-time formats below, along with any literal spaces and punctuation in between (commas do not need to be escaped; they can be used normally). In the following example, note that M must be capitalized: M/d/yyyy h:mm tt</span><br/><span class="rvts54"></span><br/><span class="rvts54">Can be </span><a class="rvts53" href="MfString.html">MfString</a><span class="rvts54"> instance or var containing string.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Remarks</span></span></h3>
<p class="rvps2"><span class="rvts6">Letters and numbers that you want to be transcribed literally from Format as return value should be enclosed in single quotes as in this example: </span><span class="rvts43">'Date:' MM/dd/yy 'Time:' hh:mm:ss tt.</span></p>
<p class="rvps2"><span class="rvts6">By contrast, non-alphanumeric characters such as spaces, tabs, linefeeds (`n), slashes, colons, commas, and other punctuation do not need to be enclosed in single quotes. The exception to this is the single quote character itself: to produce it literally, use four consecutive single quotes (''''), or just two if the quote is already inside an outer pair of quotes.</span></p>
<p class="rvps2"><span class="rvts6">If Format contains date and time elements together, they must not be intermixed. In other words, the string should be dividable into two halves: a time half and a date half. For example, a format string consisting of "hh yyyy mm" would not produce the expected result because it has a date element in between two time elements.</span></p>
<p class="rvps2"><span class="rvts6">When Format contains a numeric day of the month (either d or dd) followed by the full month name (MMMM), the genitive form of the month name is used (if the language has a genitive form).</span></p>
<p class="rvps2"><span class="rvts6">If Format contains more than 2000 characters, return will be null.</span></p>
<p class="rvps2"><span class="rvts6">Wrapper for </span><a class="rvts13" href="http://ahkscript.org/docs/commands/FormatTime.htm" target="_blank">AutoHotkey Docs - FormatTime</a><span class="rvts6">.</span><br/><span class="rvts6">Static method.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Returns</span></span></h3>
<p class="rvps2"><span class="rvts6">Returns date formated to the specified time</span></p>
<p class="rvps2"><span class="rvts6">Date Formats (case sensitive)</span></p>
<ul style="text-indent: 0px; margin-left: 24px; list-style-position: outside; list-style-type: disc;">
<li class="rvps2"><span class="rvts18">d</span><span class="rvts6"> - Day of the month without leading zero (1 - 31)</span></li>
<li class="rvps2"><span class="rvts18">dd</span><span class="rvts6"> - Day of the month with leading zero (01 – 31)</span></li>
<li class="rvps2"><span class="rvts18">ddd</span><span class="rvts6"> - Abbreviated name for the day of the week (e.g. Mon) in the current user's language</span></li>
<li class="rvps2"><span class="rvts18">dddd</span><span class="rvts6"> - Full name for the day of the week (e.g. Monday) in the current user's language</span></li>
<li class="rvps2"><span class="rvts18">M</span><span class="rvts6"> - Month without leading zero (1 – 12)</span></li>
<li class="rvps2"><span class="rvts18">MM</span><span class="rvts6"> - Month with leading zero (01 – 12)</span></li>
<li class="rvps2"><span class="rvts18">MMM</span><span class="rvts6"> - Abbreviated month name (e.g. Jan) in the current user's language</span></li>
<li class="rvps2"><span class="rvts18">MMMM</span><span class="rvts6"> - Full month name (e.g. January) in the current user's language</span></li>
<li class="rvps2"><span class="rvts18">y</span><span class="rvts6"> - Year without century, without leading zero (0 – 99)</span></li>
<li class="rvps2"><span class="rvts18">yy</span><span class="rvts6"> - Year without century, with leading zero (00 - 99)</span></li>
<li class="rvps2"><span class="rvts18">yyyy</span><span class="rvts6"> - Year with century. For example: 2005</span></li>
<li class="rvps2"><span class="rvts18">gg</span><span class="rvts6"> - Period/era string for the current user's locale (blank if none)</span></li>
</ul>
<p class="rvps2"><span class="rvts6">Time Formats (case sensitive)</span></p>
<ul style="text-indent: 0px; margin-left: 24px; list-style-position: outside; list-style-type: disc;">
<li class="rvps2"><span class="rvts18">h</span><span class="rvts6"> - Hours without leading zero; 12-hour format (1 - 12)</span></li>
<li class="rvps2"><span class="rvts18">hh</span><span class="rvts6"> - Hours with leading zero; 12-hour format (01 – 12)</span></li>
<li class="rvps2"><span class="rvts18">H</span><span class="rvts6"> - Hours without leading zero; 24-hour format (0 - 23)</span></li>
<li class="rvps2"><span class="rvts18">HH</span><span class="rvts6"> - Hours with leading zero; 24-hour format (00– 23)</span></li>
<li class="rvps2"><span class="rvts18">m</span><span class="rvts6"> - Minutes without leading zero (0 – 59)</span></li>
<li class="rvps2"><span class="rvts18">mm</span><span class="rvts6"> - Minutes with leading zero (00 – 59)</span></li>
<li class="rvps2"><span class="rvts18">s</span><span class="rvts6"> - Seconds without leading zero (0 – 59)</span></li>
<li class="rvps2"><span class="rvts18">ss</span><span class="rvts6"> - Seconds with leading zero (00 – 59)</span></li>
<li class="rvps2"><span class="rvts18">t</span><span class="rvts6"> - Single character time marker, such as A or P (depends on locale)</span></li>
<li class="rvps2"><span class="rvts18">tt</span><span class="rvts6"> - Multi-character time marker, such as AM or PM (depends on locale)</span></li>
</ul>
<p class="rvps2"><span class="rvts6">The following formats must be used alone; that is, with no other formats or text present in the Format parameter. These formats are not case sensitive.</span></p>
<ul style="text-indent: 0px; margin-left: 24px; list-style-position: outside; list-style-type: disc;">
<li class="rvps2"><span class="rvts18">(Blank)</span><span class="rvts6"> - Leave Format blank to produce the time followed by the long date. For example, in some locales it might appear as 4:55 PM Saturday, November 27, 2004</span></li>
<li class="rvps2"><span class="rvts18">Time</span><span class="rvts6"> - Time representation for the current user's locale, such as 5:26 PM</span></li>
<li class="rvps2"><span class="rvts18">ShortDate</span><span class="rvts6"> - Short date representation for the current user's locale, such as 02/29/04</span></li>
<li class="rvps2"><span class="rvts18">LongDate</span><span class="rvts6"> - Long date representation for the current user's locale, such as Friday, April 23, 2004</span></li>
<li class="rvps2"><span class="rvts18">YearMonth</span><span class="rvts6"> - Year and month format for the current user's locale, such as February, 2004</span></li>
<li class="rvps2"><span class="rvts18">YDay</span><span class="rvts6"> - Day of the year without leading zeros (1 – 366)</span></li>
<li class="rvps2"><span class="rvts18">YDay0</span><span class="rvts6"> - Day of the year with leading zeros (001 – 366)</span></li>
<li class="rvps2"><span class="rvts18">WDay</span><span class="rvts6"> - Day of the week (1 – 7). Sunday is 1.</span></li>
<li class="rvps2"><span class="rvts18">YWeek</span><span class="rvts6"> - The ISO 8601 full year and week number. For example: 200453. If the week containing January 1st has four or more days in the new year, it is considered week 1. Otherwise, it is the last week of the previous year, and the next week is week 1. Consequently, both January 4th and the first Thursday of January are always in week 1.</span></li>
</ul>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Additional Options</span></span></h3>
<p class="rvps2"><span class="rvts6">The following options can appear inside the YYYYMMDDHH24MISS parameter immediately after the timestamp (if there is no timestamp, they may be used alone). In the following example, note the lack of commas between the last four items:</span></p>
<p class="rvps14"><span class="rvts31">OutputVar := </span><span class="rvts34">Mfunc</span><span class="rvts31">.</span><span class="rvts47">FormatTime</span><span class="rvts31">(</span><span class="rvts42">"20040228 LSys D1 D4"</span><span class="rvts31">)</span></p>
<p class="rvps2"><span class="rvts18">R</span><span class="rvts6">: Reverse. Have the date come before the time (meaningful only when Format is blank).</span></p>
<p class="rvps2"><span class="rvts18">Ln</span><span class="rvts6">: If this option is not present, the current user's locale is used to format the string. To use the system's locale instead, specify LSys. To use a specific locale, specify the letter L followed by a hexadecimal or decimal locale identifier (LCID). For information on how to construct an LCID, search </span><a class="rvts14" href="http://www.microsoft.com/" target="_blank">www.microsoft.com</a><span class="rvts6"> for the followingphrase: Locale Identifiers</span></p>
<p class="rvps2"><span class="rvts18">Dn</span><span class="rvts6">: Date options. Specify for n one of the following numbers:</span><br/><span class="rvts6">0: Force the default options to be used. This also causes the short date to be in effect.</span><br/><span class="rvts6">1: Use short date (meaningful only when Format is blank; not compatible with 2 and 8).</span><br/><span class="rvts6">2: Use long date (meaningful only when Format is blank; not compatible with 1 and 8).</span><br/><span class="rvts6">4: Use alternate calendar (if any).</span><br/><span class="rvts6">8: Use Year-Month format (meaningful only when Format is blank; not compatible with 1 and 2).</span><br/><span class="rvts6">0x10: Add marks for left-to-right reading order layout.</span><br/><span class="rvts6">0x20: Add marks for right-to-left reading order layout.</span><br/><span class="rvts6">0x80000000: Do not obey any overrides the user may have in effect for the system's default date format.</span><br/><span class="rvts6">0x40000000: Use the system ANSI code page for string translation instead of the locale's code page.</span></p>
<p class="rvps2"><span class="rvts18">Tn</span><span class="rvts6">: Time options. Specify for n one of the following numbers:</span><br/><span class="rvts6">0: Force the default options to be used. This also causes minutes and seconds to be shown.</span><br/><span class="rvts6">1: Omit minutes and seconds.</span><br/><span class="rvts6">2: Omit seconds.</span><br/><span class="rvts6">4: Omit time marker (e.g. AM/PM).</span><br/><span class="rvts6">8: Always use 24-hour time rather than 12-hour time.</span><br/><span class="rvts6">12: Combination of the above two.</span><br/><span class="rvts6">0x80000000: Do not obey any overrides the user may have in effect for the system's default time format.</span><br/><span class="rvts6">0x40000000: Use the system ANSI code page for string translation instead of the locale's code page.</span></p>
<p class="rvps2"><span class="rvts18">Note</span><span class="rvts6">: Dn and Tn may be repeated to put more than one option into effect, such as this example:</span></p>
<p class="rvps14"><span class="rvts31">OutputVar := Mfunc.FormatTime("20040228 D2 D4 T1 T8")</span></p>
<p class="rvps2"><span class="rvts18">See Also</span><span class="rvts6">:</span><a class="rvts13" href="http://ahkscript.org/docs/commands/FormatTime.htm" target="_blank">AutoHotkey Docs - FormatTime</a><span class="rvts6">.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Example</span></span></h3>
<p class="rvps2"><span class="rvts6"><div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">TimeString <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime()
<span style="color: #008000">MsgBox</span> The current time <span style="color: #AA22FF; font-weight: bold">and</span> date (time first) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #19177C">%TimeString%</span><span style="color: #666666">.</span>

TimeString <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(<span style="color: #BA2121">&quot;R&quot;</span>)
<span style="color: #008000">MsgBox</span> The current time <span style="color: #AA22FF; font-weight: bold">and</span> date (date first) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #19177C">%TimeString%</span><span style="color: #666666">.</span>

TimeString <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(, <span style="color: #BA2121">&quot;Time&quot;</span>)
<span style="color: #008000">MsgBox</span> The current time <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #19177C">%TimeString%</span><span style="color: #666666">.</span>

TimeString <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime( <span style="color: #BA2121">&quot;T12&quot;</span>, <span style="color: #BA2121">&quot;Time&quot;</span>)
<span style="color: #008000">MsgBox</span> The current <span style="color: #666666">24-</span>hour time <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #19177C">%TimeString%</span><span style="color: #666666">.</span>

TimeString <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(, <span style="color: #BA2121">&quot;LongDate&quot;</span>)
<span style="color: #008000">MsgBox</span> The current date (long format) <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #19177C">%TimeString%</span><span style="color: #666666">.</span>

TimeString <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(<span style="color: #BA2121">&quot;20050423220133&quot;</span>, <span style="color: #BA2121">&quot;dddd MMMM d, yyyy hh:mm:ss tt&quot;</span>)
<span style="color: #008000">MsgBox</span> The specified date <span style="color: #AA22FF; font-weight: bold">and</span> time, when formatted, <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #19177C">%TimeString%</span><span style="color: #666666">.</span>

TimeString <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(<span style="color: #BA2121">&quot;200504&quot;</span>, <span style="color: #BA2121">&quot;'Month Name': MMMM`n'Day Name': dddd&quot;</span>)
<span style="color: #008000">MsgBox</span> <span style="color: #19177C">%TimeString%</span>

YearWeek <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(<span style="color: #BA2121">&quot;20050101&quot;</span>, <span style="color: #BA2121">&quot;YWeek&quot;</span>)
<span style="color: #008000">MsgBox</span> January <span style="color: #666666">1</span>st of <span style="color: #666666">2005</span> <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">in</span> the following ISO year <span style="color: #AA22FF; font-weight: bold">and</span> week number<span style="color: #666666">:</span> <span style="color: #19177C">%YearWeek%</span><span style="color: #408080; font-style: italic"></span>

<span style="color: #408080; font-style: italic">; Change the date-time stamp of a file:</span>
FileName <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FileSelectFile(<span style="color: #666666">3</span>,, <span style="color: #BA2121">&quot;Pick a file&quot;</span>)
<span style="color: #008000">if </span>FileName <span style="color: #666666">=</span><span style="color: #408080; font-style: italic">  ; The user didn't pick a file.</span>
    <span style="color: #008000">return</span>
FileTime <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FileGetTime(FileName)
FileTime <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(FileTime)<span style="color: #408080; font-style: italic">   ; Since the last parameter is omitted, the long date and time are retrieved.</span>
<span style="color: #008000">MsgBox</span> The selected file was last modified at <span style="color: #19177C">%FileTime%</span><span style="color: #666666">.</span><span style="color: #408080; font-style: italic"></span>

<span style="color: #408080; font-style: italic">; The following function converts the specified number of seconds into the corresponding</span>
<span style="color: #408080; font-style: italic">; number of hours, minutes, and seconds (hh:mm:ss format).</span>

<span style="color: #008000">MsgBox</span> <span style="color: #666666">%</span> FormatSeconds(<span style="color: #666666">7384</span>)<span style="color: #408080; font-style: italic">  ; 7384 = 2 hours + 3 minutes + 4 seconds. It yields: 2:03:04</span>

FormatSeconds(NumberOfSeconds)<span style="color: #408080; font-style: italic">  ; Convert the specified number of seconds to hh:mm:ss format.</span>
{
    time <span style="color: #666666">=</span> <span style="color: #666666">19990101</span><span style="color: #408080; font-style: italic">  ; *Midnight* of an arbitrary date.</span>
    time <span style="color: #666666">+=</span> <span style="color: #19177C">%NumberOfSeconds%</span>, seconds
    mmss <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>FormatTime(time, <span style="color: #BA2121">&quot;mm:ss&quot;</span>)
    <span style="color: #008000">return</span> NumberOfSeconds<span style="color: #666666">//3600</span> <span style="color: #BA2121">&quot;:&quot;</span> mmss
    <span style="color: #408080; font-style: italic">/*</span>
<span style="color: #408080; font-style: italic">    ; Unlike the method used above, this would not support more than 24 hours worth of seconds:</span>
<span style="color: #408080; font-style: italic">    ; hmmss := Mfunc.FormatTime(time, &quot;h:mm:ss&quot;)</span>
<span style="color: #408080; font-style: italic">    ; return hmmss</span>
<span style="color: #408080; font-style: italic">    */</span>
}
</pre></div>
</span></p>
</div>
	
	<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2013-2017  by Paul Moss. All Rights Reserved.</div>
		</div>
	</body>
	
</html>

