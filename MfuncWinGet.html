<html>
	
<head>
	<title>WinGet()</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="keywords" content="Win, WinGet">
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/custom.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->
	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/hnd.js"></script>
	<script type="text/javascript">
		$(document).ready(function()
		{
			if (top.frames.length == 0)
			{
				var sTopicUrl = top.location.href.substring(top.location.href.lastIndexOf("/") + 1, top.location.href.length);

				// http://www.helpndoc.com/sites/default/files/documentation/html/UseindexhtmlasthedefaultHTMLpage.html
				// change top.location.href to point to index.html
				// also comment out '' in index.pas.html to force index.html generation
				//top.location.href = "Mini-Framework.html?" + sTopicUrl;
				top.location.href = "index.html?" + sTopicId
			}
			else
			{
				var bTocSelected = false;
				(function waitForTOC()
				{
					if (top && top.FrameTOC && top.FrameTOC.SelectTocItem)
					{
						top.FrameTOC.SelectTocItem("MfuncWinGet");
						bTocSelected = true;
					}
					if (!bTocSelected) setTimeout(function() { waitForTOC(); }, 300);
				})();
			}
		});
	</script>
	
	</head>

<body>

<div id="topic_header">
			<div id="topic_header_content">
				<h1 id="topic_header_text">WinGet()</h1>
				
				<div id="topic_breadcrumb">
					<a href="NameSapce.html">Namespace</a> &rsaquo;&rsaquo; <a href="NS_System.html">System</a> &rsaquo;&rsaquo; <a href="Mfunc.html">Mfunc</a> &rsaquo;&rsaquo; <a href="MfuncMethods.html">Methods</a> &rsaquo;&rsaquo; </div>
				</div>
			<div id="topic_header_nav">
				<a href="MfuncMethods.html"><img src="img/arrow_up.png" alt="Parent"/></a>
				
				<a href="MfuncWinActivate.html"><img src="img/arrow_left.png" alt="Previous"/></a>
				
				<a href="MfuncWinGetActiveTitle.html"><img src="img/arrow_right.png" alt="Next"/></a>
				
				</div>
			<div class="clear"></div>
		</div>
	<div id="topic_content">
		
<p></p>
<h1 class="rvps11"><span class="rvts0"><span class="rvts27">WinGet()</span></span></h1>
<p class="rvps20"><span class="rvts48">OutputVar := Mfunc.WinGet([Cmd, WinTitle, WinText, ExcludeTitle, ExcludeText])</span></p>
<h2 class="rvps5"><span class="rvts0"><span class="rvts16">Mfunc.WinGet([Cmd, WinTitle, WinText, ExcludeTitle, ExcludeText])</span></span></h2>
<p class="rvps2"><span class="rvts6">Retrieves the specified window's unique ID, process ID, process name, or a list of its controls. It can also retrieve a list of all windows matching the specified criteria.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Parameters</span></span></h3>
<p class="rvps21"><span class="rvts51">Cmd</span></p>
<p class="rvps22"><span class="rvts53">See list below.</span></p>
<p class="rvps21"><span class="rvts51">WinTitle</span></p>
<p class="rvps22"><span class="rvts53">A window title or other criteria identifying the target window. See </span><a class="rvts59" href="http://ahkscript.org/docs/misc/WinTitle.htm" target="_blank">WinTitle</a><span class="rvts53">.</span><br/><span class="rvts53"></span><br/><span class="rvts53">Can be </span><a class="rvts52" href="MfString.html">MfString</a><span class="rvts53"> instance or var containing string.</span></p>
<p class="rvps21"><span class="rvts51">WinText</span></p>
<p class="rvps22"><span class="rvts53">If present, this parameter must be a substring from a single text element of the target window (as revealed by the included Window Spy utility). Hidden text elements are detected if </span><a class="rvts59" href="http://ahkscript.org/docs/commands/DetectHiddenText.htm" target="_blank">DetectHiddenText</a><span class="rvts53"> is ON.</span><br/><span class="rvts53"></span><br/><span class="rvts53">Can be </span><a class="rvts52" href="MfString.html">MfString</a><span class="rvts53"> instance or var containing string.</span></p>
<p class="rvps21"><span class="rvts51">ExcludeTitle</span></p>
<p class="rvps22"><span class="rvts53">Windows whose titles include this value will not be considered.</span><br/><span class="rvts53"></span><br/><span class="rvts53">Can be </span><a class="rvts52" href="MfString.html">MfString</a><span class="rvts53"> instance or var containing string.</span></p>
<p class="rvps21"><span class="rvts51">ExcludeText</span></p>
<p class="rvps22"><span class="rvts53">Windows whose text include this value will not be considered.</span><br/><span class="rvts53"></span><br/><span class="rvts53">Can be </span><a class="rvts52" href="MfString.html">MfString</a><span class="rvts53"> instance or var containing string.</span></p>
<p class="rvps2"><span class="rvts6">Cmd is the operation to perform, which if blank defaults to ID. It can be one of the following words:</span></p>
<p class="rvps2"><span class="rvts18">ID</span><span class="rvts6">: Retrieves the unique ID number (HWND/handle) of a window. If there is no matching window, return value is null (empty). The functions </span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinExist.htm" target="_blank">WinExist()</a><span class="rvts6"> and </span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinActive.htm" target="_blank">WinActive()</a><span class="rvts6"> can also be used to retrieve the ID of a window; for example, </span><span class="rvts43">WinExist("A")</span><span class="rvts6"> is a fast way to get the ID of the active window. To discover the HWND of a control (for use with </span><a class="rvts13" href="http://ahkscript.org/docs/commands/PostMessage.htm" target="_blank">Post/SendMessage</a><span class="rvts6"> or </span><a class="rvts13" href="http://ahkscript.org/docs/commands/DllCall.htm" target="_blank">DllCall</a><span class="rvts6">), use </span><a class="rvts13" href="http://ahkscript.org/docs/commands/ControlGet.htm#Hwnd" target="_blank">ControlGet Hwnd</a><span class="rvts6"> or </span><a class="rvts13" href="http://ahkscript.org/docs/commands/MouseGetPos.htm" target="_blank">MouseGetPos</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts18">IDLast</span><span class="rvts6">: Same as above except it retrieves the ID of the last/bottommost window if there is more than one match. If there is only one match, it performs identically to ID. This concept is similar to that used by </span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinActivateBottom.htm" target="_blank">WinActivateBottom</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts18">PID</span><span class="rvts6">: Retrieves the </span><a class="rvts13" href="http://ahkscript.org/docs/commands/Process.htm" target="_blank">Process ID (PID)</a><span class="rvts6"> of a window.</span></p>
<p class="rvps2"><span class="rvts18">ProcessName</span><span class="rvts6">: Retrieves the name of the process (e.g. notepad.exe) that owns a window. If there are no matching windows, Return value is made null (empty).</span></p>
<p class="rvps2"><span class="rvts18">ProcessPath</span><span class="rvts6"> </span><span class="rvts41">AutoHotKey [v1.1.01+]</span><span class="rvts6">: Similar to ProcessName, but retrieves the full path and name of the process instead of just the name.</span></p>
<p class="rvps2"><span class="rvts18">Count</span><span class="rvts6">: Retrieves the number of existing windows that match the specified </span><span class="rvts54">WinTitle</span><span class="rvts6">, </span><span class="rvts54">WinText</span><span class="rvts6">, </span><span class="rvts54">ExcludeTitle</span><span class="rvts6">, and </span><span class="rvts54">ExcludeText</span><span class="rvts6"> (0 if none). To count all windows on the system, omit all four title/text parameters. Hidden windows are included only if </span><a class="rvts13" href="http://ahkscript.org/docs/commands/DetectHiddenWindows.htm" target="_blank">DetectHiddenWindows</a><span class="rvts6"> has been turned on.</span></p>
<p class="rvps2"><span class="rvts18">List</span><span class="rvts6">: Retrieves the unique ID numbers of all existing windows that match the specified </span><span class="rvts54">WinTitle</span><span class="rvts6">, </span><span class="rvts54">WinText</span><span class="rvts6">, </span><span class="rvts54">ExcludeTitle</span><span class="rvts6">, and </span><span class="rvts54">ExcludeText</span><span class="rvts6"> (to retrieve all windows on the entire system, omit all four title/text parameters). Each ID number is stored in a variable whose name begins with OutputVar's own name (to form a pseudo-array), while Return value itself is set to the number of retrieved items (0 if none). For example, if Return value is var OutputVar is MyArray and two matching windows are discovered, MyArray1 will be set to the ID of the first window, MyArray2 will be set to the ID of the second window, and MyArray itself will be set to the number 2. Windows are retrieved in order from topmost to bottommost (according to how they are stacked on the desktop). Hidden windows are included only if </span><a class="rvts13" href="http://ahkscript.org/docs/commands/DetectHiddenWindows.htm" target="_blank">DetectHiddenWindows</a><span class="rvts6"> has been turned on. Within a </span><a class="rvts13" href="http://ahkscript.org/docs/Functions.htm" target="_blank">function</a><span class="rvts6">, to create a pseudo-array that is global instead of local, </span><a class="rvts13" href="http://ahkscript.org/docs/Functions.htm#Global" target="_blank">declare</a><span class="rvts6"> MyArray as a global variable prior to using this command (the converse is true for </span><a class="rvts13" href="http://ahkscript.org/docs/Functions.htm#AssumeGlobal" target="_blank">assume-global</a><span class="rvts6"> functions).</span></p>
<p class="rvps2"><span class="rvts18">MinMax</span><span class="rvts6">: Retrieves the minimized/maximized state for a window. OuputVar is made blank if no matching window exists; otherwise, it is set to one of the following numbers:</span><br/><span class="rvts6">-1: The window is minimized (</span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinRestore.htm" target="_blank">WinRestore</a><span class="rvts6"> can unminimize it).</span><br/><span class="rvts6">1: The window is maximized (</span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinRestore.htm" target="_blank">WinRestore</a><span class="rvts6"> can unmaximize it).</span><br/><span class="rvts6">0: The window is neither minimized nor maximized.</span></p>
<p class="rvps2"><span class="rvts18">ControlList</span><span class="rvts6">: Retrieves the control names for all controls in a window. If no matching window exists or there are no controls in the window, OutputVar is made blank. Otherwise, each control name consists of its class name followed immediately by its sequence number (ClassNN), as shown by Window Spy.</span></p>
<p class="rvps2"><span class="rvts6">Each item except the last is terminated by a linefeed (`n). To examine the individual control names one by one, use a parsing loop as shown in the examples section below.</span></p>
<p class="rvps2"><span class="rvts6">Controls are sorted according to their Z-order, which is usually the same order as TAB key navigation if the window supports tabbing.</span></p>
<p class="rvps2"><span class="rvts6">The control currently under the mouse cursor can be retrieved via </span><a class="rvts13" href="http://ahkscript.org/docs/commands/MouseGetPos.htm" target="_blank">MouseGetPos</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts18">ControlListHwnd</span><span class="rvts6"> </span><span class="rvts41">AutoHotKey [v1.0.43.06+]</span><span class="rvts6">: Same as above except it retrieves the window handle (HWND) of each control rather than its ClassNN.</span></p>
<p class="rvps2"><span class="rvts18">Transparent</span><span class="rvts6">: Retrieves the degree of transparency of a window (see WinSet for how to set transparency). Return value is null (empty) if:</span><br/><span class="rvts6">1) the OS is older than Windows XP</span><br/><span class="rvts6">2) there are no matching windows</span><br/><span class="rvts6">3) the window has no transparency level</span><br/><span class="rvts6">4) other conditions (caused by OS behavior)</span><br/><span class="rvts6">such as the window having been minimized, restored, and/or resized since it was made transparent. Otherwise, a number between 0 and 255 is stored, where 0 indicates an invisible window and 255 indicates an opaque window. For example:</span></p>
<p class="rvps14"><span class="rvts34">Mfunc</span><span class="rvts30">.</span><span class="rvts45">MouseGetPos</span><span class="rvts30">(,, MouseWin)</span><br/><span class="rvts30">Transparent := </span><span class="rvts34">Mfunc</span><span class="rvts30">.</span><span class="rvts45">WinGet</span><span class="rvts30">(</span><span class="rvts42">"Transparent"</span><span class="rvts30">, </span><span class="rvts42">"ahk_id"</span><span class="rvts30"> . MouseWin) </span><span class="rvts31">; Transparency of window under the mouse cursor.</span></p>
<p class="rvps2"><span class="rvts18">TransColor</span><span class="rvts6">: Retrieves the color that is marked transparent in a window (see </span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinSet.htm#TransColor" target="_blank">WinSet</a><span class="rvts6"> for how to set the TransColor). Return value is null (empty) if:</span><br/><span class="rvts6">1) the OS is older than Windows XP</span><br/><span class="rvts6">2) there are no matching windows</span><br/><span class="rvts6">3) the window has no transparent color</span><br/><span class="rvts6">4) other conditions (caused by OS behavior)</span><br/><span class="rvts6">such as the window having been minimized, restored, and/or resized since it was made transparent. Otherwise, a six-digit hexadecimal RGB color is stored, e.g. 0x00CC99. For example:</span></p>
<p class="rvps14"><span class="rvts34">Mfunc</span><span class="rvts30">.</span><span class="rvts45">MouseGetPos</span><span class="rvts30">(,, MouseWin)</span><br/><span class="rvts30">TransColor := </span><span class="rvts34">Mfunc</span><span class="rvts30">.</span><span class="rvts45">WinGet</span><span class="rvts30">(</span><span class="rvts42">"Transparent"</span><span class="rvts30">, </span><span class="rvts42">"ahk_id"</span><span class="rvts30"> . MouseWin) </span><span class="rvts31">; TransColor of the window under the mouse cursor.</span></p>
<p class="rvps2"><span class="rvts18">Style</span><span class="rvts6"> or </span><span class="rvts18">ExStyle</span><span class="rvts6">: Retrieves an 8-digit hexadecimal number representing style or extended style (respectively) of a window. If there are no matching windows, OutputVar is made blank. The following example determines whether a window has the WS_DISABLED style:</span></p>
<p class="rvps14"><span class="rvts30">Style := Mfunc.WinGet("Style", "My Window Title")</span><br/><span class="rvts30">if (Style &amp; 0x8000000) </span><span class="rvts31">; 0x8000000 is WS_DISABLED.</span><br/><span class="rvts31">;... the window is disabled, so perform appropriate action.</span></p>
<p class="rvps2"><span class="rvts6">The next example determines whether a window has the WS_EX_TOPMOST style (always-on-top):</span></p>
<p class="rvps14"><span class="rvts30">ExStyle := &nbsp;</span><span class="rvts34">Mfunc</span><span class="rvts30">.</span><span class="rvts45">WinGet</span><span class="rvts30">(</span><span class="rvts42">"ExStyle"</span><span class="rvts30">, </span><span class="rvts42">"My Window Title"</span><span class="rvts30">)</span><br/><span class="rvts32">if</span><span class="rvts30"> (ExStyle &amp; </span><span class="rvts72">0x8</span><span class="rvts30">) </span><span class="rvts31">; 0x8 is WS_EX_TOPMOST.</span><br/><span class="rvts31">;... the window is always-on-top, so perform appropriate action.</span></p>
<p class="rvps2"><span class="rvts6">See the </span><a class="rvts13" href="http://ahkscript.org/docs/misc/Styles.htm" target="_blank">styles table</a><span class="rvts6"> for a partial listing of styles.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Returns</span></span></h3>
<p class="rvps2"><span class="rvts6">Returns the result of Cmd.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Remarks</span></span></h3>
<p class="rvps2"><span class="rvts6">Wrapper for </span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinGet.htm" target="_blank">AutoHotkey Docs - WinGet</a><span class="rvts6">.</span><br/><span class="rvts15">Static method.</span></p>
<p class="rvps2"><span class="rvts6">A window's ID number is valid only during its lifetime. In other words, if an application restarts, all of its windows will get new ID numbers.</span></p>
<p class="rvps2"><span class="rvts6">ID numbers retrieved by this command are numeric (the prefix "ahk_id" is not included) and are stored in hexadecimal format regardless of the setting of </span><a class="rvts12" href="MfuncSetFormat.html">Mfunc.SetFormat</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6">The ID of the window under the mouse cursor can be retrieved with </span><a class="rvts12" href="MfuncMouseGetPos.html">Mfunc.MouseGetPos</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6">Although ID numbers are currently 32-bit unsigned integers, they may become 64-bit in future versions. Therefore, it is unsafe to perform numerical operations such as addition on these values because such operations require that their input strings be parsable as signed rather than unsigned integers.</span></p>
<p class="rvps2"><span class="rvts6">Window titles and text are case sensitive. Hidden windows are not detected unless </span><a class="rvts13" href="http://ahkscript.org/docs/commands/DetectHiddenWindows.htm" target="_blank">DetectHiddenWindows</a><span class="rvts6"> has been turned on.</span></p>
<p class="rvps2"><span class="rvts6">Any and/or all parameter for this function can be instance of </span><a class="rvts12" href="MfString.html">MfString</a><span class="rvts6"> or var containing string.</span></p>
<p class="rvps2"><span class="rvts18">See Also</span><span class="rvts6">:</span><a class="rvts13" href="http://ahkscript.org/docs/commands/WinGet.htm" target="_blank">AutoHotkey Docs - WinGet</a><span class="rvts6">.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Example</span></span></h3>
<p class="rvps2"><span class="rvts6"><div style="background: #f8f8f8; overflow: auto; width: auto; border: solid gray; border-width: .1em .1em .1em .8em; padding: .2em .6em;">
<pre style="margin: 0; line-height: 125%;"><span style="color: #408080; font-style: italic;">; Example #1: Maximize the active window and report its unique ID:</span>
<span style="color: #008000;">WinGet</span>, active_id, ID, A
<span style="color: #008000;">WinMaximize</span>, ahk_id <span style="color: #19177c;">%active_id%</span>
<span style="color: #008000;">MsgBox</span>, The active window's ID <span style="color: #aa22ff; font-weight: bold;">is</span> <span style="color: #ba2121;">"%active_id%"</span><span style="color: #666666;">.</span>

<span style="color: #408080; font-style: italic;">; Example #2: This will visit all windows on the entire system and display info about each of them:</span>
Id <span style="color: #666666;">:=</span> Mfunc<span style="color: #666666;">.</span>WinGet(<span style="color: #ba2121;">"list"</span>,,, <span style="color: #ba2121;">"Program Manager"</span>)
<span style="color: #008000;">Loop</span>, <span style="color: #19177c;">%id%</span>
{
    this_id <span style="color: #666666;">:=</span> id<span style="color: #19177c;">%A_Index%</span>
    <span style="color: #000080;">Mfunc.WinActivate</span>(<span style="color: #ba2121;">"ahk_id"</span> <span style="color: #666666;">.</span> this_id)
    this_class <span style="color: #666666;">:=</span> <span style="color: #000080;">Mfunc.WinGetClass</span>(<span style="color: #ba2121;">"ahk_id"</span> <span style="color: #666666;">.</span> this_id)
    this_title <span style="color: #666666;">:=</span> <span style="color: #000080;">Mfunc.WinGetTitle</span>(<span style="color: #ba2121;">"ahk_id"</span> <span style="color: #666666;">.</span> this_id)
    <span style="color: #008000;">MsgBox</span>, <span style="color: #666666;">4</span>, , Visiting All Windows<span style="color: #bb6622; font-weight: bold;">`n</span><span style="color: #19177c;">%a_index%</span> of <span style="color: #19177c;">%id%</span><span style="color: #bb6622; font-weight: bold;">`n</span>ahk_id <span style="color: #19177c;">%this_id%</span><span style="color: #bb6622; font-weight: bold;">`n</span>ahk_class <span style="color: #19177c;">%this_class%</span><span style="color: #bb6622; font-weight: bold;">`n</span><span style="color: #19177c;">%this_title%</span><span style="color: #bb6622; font-weight: bold;">`n`n</span>Continue<span style="color: #666666;">?</span>
    <span style="color: #008000;">IfMsgBox</span>, NO, break
}

<span style="color: #408080; font-style: italic;">; Example #3: Extract the individual control names from a ControlList:</span>
ActiveControlList <span style="color: #666666;">:=</span><span style="color: #000080;"> Mfunc.WinGet</span>(<span style="color: #ba2121;">"ControlList"</span>, <span style="color: #ba2121;">"A"</span>)
<span style="color: #008000;">Loop</span>, Parse, ActiveControlList, <span style="color: #bb6622; font-weight: bold;">`n</span>
{
    <span style="color: #008000;">MsgBox</span>, <span style="color: #666666;">4</span>,, Control #<span style="color: #19177c;">%a_index%</span> <span style="color: #aa22ff; font-weight: bold;">is</span> <span style="color: #ba2121;">"%A_LoopField%"</span><span style="color: #666666;">.</span> Continue<span style="color: #666666;">?</span>
    <span style="color: #008000;">IfMsgBox</span>, No
        <span style="color: #008000;">break</span>
}

<span style="color: #408080; font-style: italic;">; Example #4: Display in real time the active window's control list:</span>
<span style="color: #008000;">#Persistent</span>
<span style="color: #008000;">SetTimer</span>, WatchActiveWindow, <span style="color: #666666;">200</span>
<span style="color: #008000;">return</span>

<span style="color: #a0a000;">WatchActiveWindow:</span>
ControlList <span style="color: #666666;">:=</span> <span style="color: #000080;">Mfunc.WinGet</span>(<span style="color: #ba2121;">"ControlList"</span>, <span style="color: #ba2121;">"A"</span>)
<span style="color: #008000;">ToolTip</span>, <span style="color: #19177c;">%ControlList%</span>
<span style="color: #008000;">return</span>
</pre>
</div></span></p>
</div>
	
	<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2013-2017  by Paul Moss. All Rights Reserved.</div>
		</div>
	</body>
	
</html>

