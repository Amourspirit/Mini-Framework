<html>
	
<head>
	<title>FileSelectFolder()</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="keywords" content="File, Folder, FileSelectFolder">
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/custom.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->
	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/hnd.js"></script>
	<script type="text/javascript">
		$(document).ready(function()
		{
			if (top.frames.length == 0)
			{
				var sTopicUrl = top.location.href.substring(top.location.href.lastIndexOf("/") + 1, top.location.href.length);
				top.location.href = "index.html?" + sTopicUrl
			}
			else
			{
				var bTocSelected = false;
				(function waitForTOC()
				{
					if (top && top.FrameTOC && top.FrameTOC.SelectTocItem)
					{
						top.FrameTOC.SelectTocItem("MfuncFileSelectFolder");
						bTocSelected = true;
					}
					if (!bTocSelected) setTimeout(function() { waitForTOC(); }, 300);
				})();
			}
		});
	</script>
	
	</head>

<body>

<div id="topic_header">
			<div id="topic_header_content">
				<h1 id="topic_header_text">FileSelectFolder()</h1>
				
				<div id="topic_breadcrumb">
					<a href="NameSapce.html">Namespace</a> &rsaquo;&rsaquo; <a href="NS_System.html">System</a> &rsaquo;&rsaquo; <a href="Mfunc.html">Mfunc</a> &rsaquo;&rsaquo; <a href="MfuncMethods.html">Methods</a> &rsaquo;&rsaquo; </div>
				</div>
			<div id="topic_header_nav">
				<a href="MfuncMethods.html"><img src="img/arrow_up.png" alt="Parent"/></a>
				
				<a href="MfuncFileSelectFile.html"><img src="img/arrow_left.png" alt="Previous"/></a>
				
				<a href="MfuncFileSetAttrib.html"><img src="img/arrow_right.png" alt="Next"/></a>
				
				</div>
			<div class="clear"></div>
		</div>
	<div id="topic_content">
		
<p></p>
<h1 class="rvps11"><span class="rvts0"><span class="rvts27">FileSelectFolder()</span></span></h1>
<p class="rvps20"><span class="rvts48">OutputVar := Mfunc.FileSelectFolder([StartingFolder, Options, Prompt])</span></p>
<h2 class="rvps5"><span class="rvts0"><span class="rvts16">Mfunc.FileSelectFolder([StartingFolder, Options, Prompt])</span></span></h2>
<p class="rvps2"><span class="rvts6">Displays a standard dialog that allows the user to select a folder.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Parameters</span></span></h3>
<p class="rvps21"><span class="rvts51">StartingFolder</span></p>
<p class="rvps22"><span class="rvts53">If blank or omitted, the dialog's initial selection will be the user's My Documents folder (or possibly My Computer). A </span><a class="rvts59" href="http://ahkscript.org/docs/misc/CLSID-List.htm" target="_blank">CLSID folder</a><span class="rvts53"> such as</span><span class="rvts101"> ::{20d04fe0-3aea-1069-a2d8-08002b30309d}</span><span class="rvts53"> (i.e. My Computer) may be specified start navigation at a specific special folder.</span><br/><span class="rvts53"></span><br/><span class="rvts53">Otherwise, the most common usage of this parameter is an asterisk followed immediately by the absolute path of the drive or folder to be initially selected. For example, </span><span class="rvts101">*C:\</span><span class="rvts53"> would initially select the C drive. Similarly, </span><span class="rvts101">*C:\My Folder</span><span class="rvts53"> would initially select that particular folder.</span><br/><span class="rvts53"></span><br/><span class="rvts53">The asterisk indicates that the user is permitted to navigate upward (closer to the root) from the starting folder. Without the asterisk, the user would be forced to select a folder inside StartingFolder (or StartingFolder itself). One benefit of omitting the asterisk is that StartingFolder is initially shown in a tree-expanded state, which may save the user from having to click the first plus sign.</span><br/><span class="rvts53"></span><br/><span class="rvts53">If the asterisk is present, upward navigation may optionally be restricted to a folder other than Desktop. This is done by preceding the asterisk with the absolute path of the uppermost folder followed by exactly one space or tab. In the following example, the user would not be allowed to navigate any higher than C:\My Folder (but the initial selection would be C:\My Folder\Projects):</span><br/><span class="rvts101">C:\My Folder *C:\My Folder\Projects</span></p>
<p class="rvps21"><span class="rvts51">Options</span></p>
<p class="rvps22"><span class="rvts53">One of the following numbers:</span><br/><span class="rvts53"></span><br/><span class="rvts75">0</span><span class="rvts53">: The options below are all disabled (except on Windows 2000, where the "make new folder" button might appear anyway).</span><br/><span class="rvts53"></span><br/><span class="rvts75">1</span><span class="rvts53"> (default): A button is provided that allows the user to create new folders.</span><br/><span class="rvts53"></span><br/><span class="rvts75">Add 2</span><span class="rvts53"> to the above number to provide an edit field that allows the user to type the name of a folder. For example, a value of 3 for this parameter provides both an edit field and a "make new folder" button.</span><br/><span class="rvts53"></span><br/><span class="rvts75">Add 4</span><span class="rvts53"> to the above number to omit the BIF_NEWDIALOGSTYLE property. Adding 4 ensures that FileSelectFolder will work properly even in a Preinstallation Environment like WinPE or BartPE. However, this prevents the appearance of a "make new folder" button, at least on Windows XP. ["4" requires v1.0.48+]</span><br/><span class="rvts53"></span><br/><span class="rvts53">If the user types an invalid folder name in the edit field, OutputVar will be set to the folder selected in the navigation tree rather than what the user entered, at least on Windows XP.</span><br/><span class="rvts53"></span><br/><span class="rvts53">This parameter can be an </span><a class="rvts59" href="http://ahkscript.org/docs/Variables.htm#Expressions" target="_blank">expression</a><span class="rvts53">.</span></p>
<p class="rvps21"><span class="rvts51">Prompt</span></p>
<p class="rvps22"><span class="rvts53">Text displayed in the window to instruct the user what to do. If omitted or blank, it will default to "Select Folder - %A_SCRIPTNAME%" (i.e. the name of the current script).</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Returns</span></span></h3>
<p class="rvps2"><span class="rvts6">Returns the user's selected folder. This will be made blank if the user cancels the dialog (i.e. does not wish to select a folder). If the user selects a root directory (such as C:), OutputVar will contain a trailing backslash. If this is undesirable, remove it as follows:</span></p>
<p class="rvps14"><span class="rvts30">Folder := </span><span class="rvts33">Mfunc</span><span class="rvts30">.</span><span class="rvts45">FileSelectFolder</span><span class="rvts30">()</span><br/><span class="rvts30">Folder := </span><span class="rvts45">RegExReplace</span><span class="rvts30">(Folder, </span><span class="rvts42">"\\$"</span><span class="rvts30">) </span><span class="rvts31">; Removes the trailing backslash, if present.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Throws</span></span></h3>
<p class="rvps2"><span class="rvts6">Throws </span><a class="rvts12" href="MfException.html">MfException</a><span class="rvts6"> throw any errors with </span><a class="rvts12" href="MfExceptionInnerException.html">InnerException</a><span class="rvts6"> set to the </span><a class="rvts13" href="http://ahkscript.org/docs/commands/FileSelectFolder.htm" target="_blank">Autohotkey - FileSelectFolder</a><span class="rvts6"> error message.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Remarks</span></span></h3>
<p class="rvps2"><span class="rvts6">Wrapper for </span><a class="rvts13" href="http://ahkscript.org/docs/commands/FileSelectFolder.htm" target="_blank">AutoHotkey Docs - FileSelectFolder</a><span class="rvts6">.</span><br/><span class="rvts15">Static method.</span></p>
<p class="rvps2"><span class="rvts6">If the user didn't select anything (e.g. pressed CANCEL), return is null. </span><a class="rvts13" href="http://ahkscript.org/docs/misc/ErrorLevel.htm" target="_blank">ErrorLevel</a><span class="rvts6"> is set to 1. No Exception is thrown on Cancel.</span></p>
<p class="rvps2"><span class="rvts6">A GUI window may display a modal folder-selection dialog by means of </span><a class="rvts13" href="http://ahkscript.org/docs/commands/Gui.htm#OwnDialogs" target="_blank">Gui +OwnDialogs</a><span class="rvts6">. A modal dialog prevents the user from interacting with the GUI window until the dialog is dismissed.</span></p>
<p class="rvps2"><span class="rvts6">Known limitation: A </span><a class="rvts13" href="http://ahkscript.org/docs/commands/SetTimer.htm" target="_blank">timer</a><span class="rvts6"> that launches during the display of a FileSelectFolder dialog will postpone the effect of the user's clicks inside the dialog until after the timer finishes. To work around this, avoid using timers whose subroutines take a long time to finish, or disable all timers during the dialog:</span></p>
<p class="rvps14"><span class="rvts30">Thread, NoTimers</span><br/><span class="rvts30">FileSelectFile, OutputVar</span><br/><span class="rvts30">Thread, NoTimers, false</span></p>
<p class="rvps2"><span class="rvts6">Any and/or all parameter for this function can be instance of </span><a class="rvts12" href="MfString.html">MfString</a><span class="rvts6"> or var containing </span><span class="rvts15">string</span><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts18">See Also</span><span class="rvts6">:</span><a class="rvts13" href="http://ahkscript.org/docs/commands/FileSelectFolder.htm" target="_blank">AutoHotkey Docs - FileSelectFolder</a><span class="rvts6">.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Example</span></span></h3>
<p class="rvps14"><span class="rvts30">OutputVar := </span><span class="rvts33">Mfunc</span><span class="rvts30">.</span><span class="rvts45">FileSelectFolder</span><span class="rvts30">( , </span><span class="rvts72">3</span><span class="rvts30">)</span><br/><span class="rvts32">if</span><span class="rvts30"> OutputVar = </span><br/><span class="rvts30"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts32">MsgBox</span><span class="rvts30">, You didn't select a folder.</span><br/><span class="rvts30">else</span><br/><span class="rvts30"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="rvts32">MsgBox</span><span class="rvts30">, You selected folder "%OutputVar%".</span><br/><span class="rvts30"></span><br/><span class="rvts31">; CLSID Example:</span><br/><span class="rvts30">OutputVar := </span><span class="rvts33">Mfunc</span><span class="rvts30">.</span><span class="rvts45">FileSelectFolder</span><span class="rvts30">(</span><span class="rvts42">"::{20d04fe0-3aea-1069-a2d8-08002b30309d}"</span><span class="rvts30">) </span><span class="rvts31">; My Computer.</span></p>
</div>
	
	<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2013-2017  by Paul Moss. All Rights Reserved.</div>
		</div>
	</body>
	
</html>

