<html>
	
<head>
	<title>RegRead()</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="keywords" content="RegRead, Registry">
	
	<link type="text/css" rel="stylesheet" media="all" href="css/reset.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/base.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/hnd.css" />
	<link type="text/css" rel="stylesheet" media="all" href="css/custom.css" />
	<!--[if lte IE 8]>
		<link type="text/css" rel="stylesheet" media="all" href="css/ielte8.css" />
	<![endif]-->
	<style type="text/css">
		#topic_header
		{
			background-color: #EFEFEF;
		}
	</style>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/hnd.js"></script>
	<script type="text/javascript">
		$(document).ready(function()
		{
			if (top.frames.length == 0)
			{
				var sTopicUrl = top.location.href.substring(top.location.href.lastIndexOf("/") + 1, top.location.href.length);
				top.location.href = "index.html?" + sTopicUrl
			}
			else
			{
				var bTocSelected = false;
				(function waitForTOC()
				{
					if (top && top.FrameTOC && top.FrameTOC.SelectTocItem)
					{
						top.FrameTOC.SelectTocItem("MfuncRegRead");
						bTocSelected = true;
					}
					if (!bTocSelected) setTimeout(function() { waitForTOC(); }, 300);
				})();
			}
		});
	</script>
	
	</head>

<body>

<div id="topic_header">
			<div id="topic_header_content">
				<h1 id="topic_header_text">RegRead()</h1>
				
				<div id="topic_breadcrumb">
					<a href="NameSapce.html">Namespace</a> &rsaquo;&rsaquo; <a href="NS_System.html">System</a> &rsaquo;&rsaquo; <a href="Mfunc.html">Mfunc</a> &rsaquo;&rsaquo; <a href="MfuncMethods.html">Methods</a> &rsaquo;&rsaquo; </div>
				</div>
			<div id="topic_header_nav">
				<a href="MfuncMethods.html"><img src="img/arrow_up.png" alt="Parent"/></a>
				
				<a href="MfuncRandom.html"><img src="img/arrow_left.png" alt="Previous"/></a>
				
				<a href="MfuncRegWrite.html"><img src="img/arrow_right.png" alt="Next"/></a>
				
				</div>
			<div class="clear"></div>
		</div>
	<div id="topic_content">
		
<p></p>
<h1 class="rvps11"><span class="rvts0"><span class="rvts27">RegRead()</span></span></h1>
<p class="rvps20"><span class="rvts48">OutputVar := Mfunc.RegRead(RootKey, SubKey [, ValueName])</span></p>
<h2 class="rvps5"><span class="rvts0"><span class="rvts16">Mfunc.RegRead(RootKey, SubKey [, ValueName])</span></span></h2>
<p class="rvps2"><span class="rvts6">Reads a value from the registry.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Parameters</span></span></h3>
<p class="rvps21"><span class="rvts51">RootKey</span></p>
<p class="rvps22"><span class="rvts53">Must be either HKEY_LOCAL_MACHINE, HKEY_USERS, HKEY_CURRENT_USER, HKEY_CLASSES_ROOT, or HKEY_CURRENT_CONFIG (or the abbreviations for each of these, such as HKLM). To access a remote registry, prepend the computer name and a colon, as in this example: \workstation01:HKEY_LOCAL_MACHINE</span></p>
<p class="rvps21"><span class="rvts51">SubKey</span></p>
<p class="rvps22"><span class="rvts53">The name of the subkey (e.g. Software\SomeApplication).</span></p>
<p class="rvps21"><span class="rvts51">ValueName</span></p>
<p class="rvps22"><span class="rvts53">The name of the value to retrieve. If omitted, Subkey's default value will be retrieved, which is the value displayed as "(Default)" by RegEdit. If there is no default value (that is, if RegEdit displays "value not set"), OutputVar is made blank and ErrorLevel is set to 1.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Returns</span></span></h3>
<p class="rvps2"><span class="rvts6">Returns the name of the variable in which to store the retrieved value. If the value cannot be retrieved, the variable is made blank and </span><a class="rvts13" href="http://ahkscript.org/docs/misc/ErrorLevel.htm" target="_blank">ErrorLevel</a><span class="rvts6"> is set to 1.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Throws</span></span></h3>
<p class="rvps2"><span class="rvts6">Throws </span><a class="rvts12" href="MfException.html">MfException</a><span class="rvts6"> is non-zero then </span><a class="rvts12" href="MfExceptionInnerException.html">InnerException</a><span class="rvts6"> message is set to the value of </span><a class="rvts13" href="http://ahkscript.org/docs/Variables.htm#LastError" target="_blank">A_LastError</a></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Remarks</span></span></h3>
<p class="rvps2"><span class="rvts6">Wrapper for </span><a class="rvts13" href="http://ahkscript.org/docs/commands/RegRead.htm" target="_blank">AutoHotkey Docs - RegRead</a><span class="rvts6">.</span><br/><span class="rvts6">Static method.</span></p>
<p class="rvps2"><span class="rvts6">Currently only the following value types are supported: REG_SZ, REG_EXPAND_SZ, REG_MULTI_SZ, REG_DWORD, and REG_BINARY.</span></p>
<p class="rvps2"><span class="rvts6">REG_DWORD values are always expressed as positive decimal numbers.</span></p>
<p class="rvps2"><span class="rvts6">When reading a REG_BINARY key the result is a string of hex characters. For example, the REG_BINARY value of 01,a9,ff,77 will be read as the string 01A9FF77.</span></p>
<p class="rvps2"><span class="rvts6">When reading a REG_MULTI_SZ key, each of the components ends in a linefeed character (`n). If there are no components, Return value will be made blank. See </span><a class="rvts12" href="MfuncFileSelectFile.html">Mfunc.FileSelectFile</a><span class="rvts6"> for an example of how to extract the individual components from return value.</span></p>
<p class="rvps2"><span class="rvts6">REG_BINARY values larger than 64K can only be read in </span><span class="rvts41">AutoHotkey [v1.1.10.01+]</span><span class="rvts6"> and later.</span></p>
<p class="rvps2"><span class="rvts6">To retrieve and operate upon multiple registry keys or values, consider using a </span><a class="rvts13" href="http://ahkscript.org/docs/commands/LoopReg.htm" target="_blank">registry-loop</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6">For details about how to access the registry of a remote computer, see the remarks in </span><a class="rvts13" href="http://ahkscript.org/docs/commands/LoopReg.htm" target="_blank">registry-loop</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6">To read and write entries from the 64-bit sections of the registry in a 32-bit script or vice versa, use </span><a class="rvts13" href="http://ahkscript.org/docs/commands/SetRegView.htm" target="_blank">SetRegView</a><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6">Any and/or all parameter for this function can be instance of </span><a class="rvts12" href="MfString.html">MfString</a><span class="rvts6"> or var containing </span><span class="rvts15">string</span><span class="rvts6">.</span></p>
<p class="rvps2"><span class="rvts6">See Also:</span><a class="rvts13" href="http://ahkscript.org/docs/commands/RegRead.htm" target="_blank">AutoHotkey Docs - RegRead</a><span class="rvts6">.</span></p>
<h3 class="rvps6"><span class="rvts0"><span class="rvts17">Example</span></span></h3>
<p class="rvps2"><span class="rvts6"><div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">OutputVar <span style="color: #666666">:=</span> Mfunc<span style="color: #666666">.</span>RegRead(<span style="color: #BA2121">&quot;HKEY_LOCAL_MACHINE&quot;</span>, <span style="color: #BA2121">&quot;SOFTWARE\Microsoft\Windows\CurrentVersion&quot;</span>, <span style="color: #BA2121">&quot;ProgramFilesDir&quot;</span>)
<span style="color: #008000">MsgBox</span>, Program files are <span style="color: #AA22FF; font-weight: bold">in</span><span style="color: #666666">:</span> <span style="color: #19177C">%OutputVar%</span><span style="color: #408080; font-style: italic"></span>

<span style="color: #408080; font-style: italic">; The following example retrieves  the TYPE of a registry value (e.g. REG_SZ or REG_DWORD).</span>
<span style="color: #008000">MsgBox</span> <span style="color: #666666">%</span> RegKeyType(<span style="color: #BA2121">&quot;HKCU&quot;</span>, <span style="color: #BA2121">&quot;Environment&quot;</span>, <span style="color: #BA2121">&quot;TEMP&quot;</span>)
<span style="color: #008000">return</span>

RegKeyType(RootKey, SubKey, ValueName)<span style="color: #408080; font-style: italic">  ; This function returns the type of the specified value.</span>
{
    <span style="color: #008000">Loop</span>, <span style="color: #19177C">%RootKey%</span>, <span style="color: #19177C">%SubKey%</span>
        if (<span style="color: #19177C">A_LoopRegName</span> <span style="color: #666666">=</span> ValueName)
            <span style="color: #008000">return</span> <span style="color: #19177C">A_LoopRegType</span>
    <span style="color: #008000">return</span> <span style="color: #BA2121">&quot;Error&quot;</span>
}
</pre></div>
</span></p>
</div>
	
	<div id="topic_footer">

			<div id="topic_footer_content">
				Copyright &copy; 2013-2017  by Paul Moss. All Rights Reserved.</div>
		</div>
	</body>
	
</html>

